
# =============
#    GENERAL
# =============

# Restore default settings
source-file ~/.tmux/default.conf

# Load custom theme
source-file ~/.tmux/colors.conf
source-file ~/.tmux/theme.conf

# Enable mouse key bindings
source-file ~/.tmux/mouse.conf
#unbind-key -a
#q Send prefix

#unbind-key C-a
unbind-key C-'\'
unbind C-'\'
unbind-key C-Space
unbind-key Space
unbind C-Space
unbind C-space
unbind space
unbind Space
unbind C-b

set-option -g prefix ^^ #C-`
bind-key ^^ send-prefix # C-`

# Reload .tmux.conf <C-F5>
bind-key -n C-F5 source-file ~/.tmux.conf

bind-key Enter command-prompt

# Faster Escape
set-option -sg escape-time 1

#set -g default-terminal xterm-256color
#set -g terminal-overrides "xterm*:kLFT5=\eOD:kRIT5=\eOC:kUP5=\eOA:kDN5=\eOB:smkx@:rmkx@"
set-window-option -g xterm-keys on


# Use UTF-8
#set-window-option -g utf8 on

# Update Environment
set-option -g  update-environment DISPLAY
set-option -ga update-environment SSH_ASKPASS
set-option -ga update-environment SSH_AUTH_SOCK
set-option -ga update-environment SSH_AGENT_PID
set-option -ga update-environment SSH_CONNECTION
set-option -ga update-environment WINDOWID
set-option -ga update-environment XAUTHORITY


# ===========
#    TITLE
# ===========
#set-option -g set-titles on
set-option -g set-titles off
set-option -g set-titles-string ""


# ============
#    CLIENT
# ============

# Detach Client <Ctrl-n>
bind-key -n C-q detach-client


# =============
#    SESSION
# =============

# --- Session Shortcuts ---

# Choose Session <M-a>
#bind-key -n M-a choose-session

# Switch Sessions <Alt-Shift-Direction>
bind-key -n M-J switch-client -n
bind-key -n M-K switch-client -p

# Switch Sessions <Alt-Shift-Direction>
bind-key -n M-J switch-client -n
bind-key -n M-K switch-client -p

# Switch Sessions <Alt-Shift-Direction>
bind-key -n M-J switch-client -n
bind-key -n M-K switch-client -p

# Rename Session <Ctrl-R>
#bind-key -n C-R command-prompt 'rename-session %%'
#bind-key -n C-S-R command-prompt 'rename-session %%'


# =============
#    WINDOWS
# =============

# --- Window Options ---

# Set base index to 1 (makes more sense than 0)
set-window-option -g base-index 1

# Automatically renumber windows
set-option -g renumber-windows on

# --- Window Shortcuts ---

# New Window <Alt-Shift-N>
bind-key -n M-N new-window -c '#{pane_current_path}'

# Switch Windows <Alt-Shift-Direction>
bind-key -n S-M-Left previous-window
bind-key -n S-M-Right next-window

# Swap Windows <Alt-Shift-Arrow>
# bind-key -n S-M-Left  swap-window -t -1
# bind-key -n S-M-Right swap-window -t +1

# Close Window <Alt-Shift-W>
#bind-key -n M-W confirm-before -p "kill-window #W? (y/n)" kill-window
bind-key W kill-window
bind-key w kill-pane
# Rename Window <Ctrl-r>
#bind-key -n C-r command-prompt 'rename-window %%'

# Select Windows <Alt-#>
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9
bind-key -n M-0 select-window -t 10

# Switch To Last Window <M-_>
bind-key -n M-_ select-window -l

# ===========
#    Panes
# ===========

# --- Base Index ---
set-window-option -g pane-base-index 1

# --- New Pane <Alt-s/v> ---
# bind-key -n M-v split-window -h -c '#{pane_current_path}'
# bind-key -n M-s split-window -v -c '#{pane_current_path}'

# --- New Pane <Prefix -|> ---
bind-key | split-window -h
bind-key - split-window -v

# --- Switch Panes <Alt-Direction> ---
# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
# Disabled because switching is too laggy
#tmux_select_pane_left=M-h
#tmux_select_pane_right=M-l
#tmux_select_pane_up=M-k
#tmux_select_pane_down=M-j
#tmux_select_pane_last=M--
#is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
#bind-key -n $tmux_select_pane_left if-shell "$is_vim" "send-keys $tmux_select_pane_left" "select-pane -L"
#bind-key -n $tmux_select_pane_right if-shell "$is_vim" "send-keys $tmux_select_pane_right" "select-pane -R"
#bind-key -n $tmux_select_pane_up if-shell "$is_vim" "send-keys $tmux_select_pane_up" "select-pane -U"
#bind-key -n $tmux_select_pane_down if-shell "$is_vim" "send-keys $tmux_select_pane_down" "select-pane -D"
#bind-key -n $tmux_select_pane_last if-shell "$is_vim" "send-keys $tmux_select_pane_last" "select-pane -l"
bind-key -n M-Up    select-pane -U
bind-key -n M-Down  select-pane -D
bind-key -n M-Left  select-pane -L
bind-key -n M-Right select-pane -R

# --- Resize Pane <Alt-Arrow> ---
# bind-key -n M-Left  resize-pane -L #
# bind-key -n M-Right resize-pane -R
# bind-key -n M-Up    resize-pane -U
# bind-key -n M-Down  resize-pane -D

# --- Zoom Pane <Alt-f> ---
bind-key -n M-= resize-pane -Z

# --- Swap Panes <Alt-page up/down> ---
# bind-key -n M-PPage swap-pane -U
# bind-key -n M-NPage swap-pane -D

# --- Close Pane <Alt-w> ---
#bind-key -n M-w confirm-before -p "kill-pane #P? (y/n)" kill-pane
# bind-key -n M-End kill-pane



# ===========
#    MOUSE
# ===========
# set-option -g mouse off
#set-option -g mouse-utf8 off

# # click window to select
# bind-key -n MouseDown1Status select-window -t =

# # Click pane to select
# #bind-key -n MouseDown1Pane "select-pane -t = \; send-keys -M"
# bind-key -n MouseDown1Pane select-pane -t = \; send-keys -M

# # Drag border to resize pane
# bind-key -n MouseDrag1Border resize-pane -M

#bind-key -n MouseDrag1Pane select-window -t =
#bind-key -n MouseDrag1Pane if-shell -F -t = #{mouse_any_flag} "if -Ft= "#{pane_in_mode}" "copy-mode -M" "send-keys -M"" "copy-mode -M"

# Deprecated
#set-window-option -g mouse-select-pane on
#set-window-option -g mouse-resize-pane on
#set-window-option -g mouse-select-window on

# =============
#    VI MODE
# =============

# Disable clipboard control sequence
# (prevents gibberish from being printed)
set-option -s set-clipboard off

# Use vi mode
#set-window-option -g mode-keys vi

# Paste Buffer <C-p>
bind-key -n C-p choose-buffer "paste-buffer -b %%"

# Enter Copy Mode <C-y>
#bind-key -n C-y copy-mode

# Begin Selection <v>
bind-key -T copy-mode-vi v send-keys -X begin-selection

# Copy Selection to System Clipboard <y>
bind-key -T copy-mode-vi y send-keys -X copy-pipe xclip

# End of Line <L>
bind-key -T copy-mode-vi L send-keys -X end-of-line

# Start of Line <H>
bind-key -T copy-mode-vi H send-keys -X start-of-line


# ==========
#    MISC
# ==========

bind -n End send-key C-e
bind -n Home send-key C-a

source-file ~/.tmux/plugins.conf

# Done!
#display-message "Configuration loaded!"

# List of Plugins:

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'Morantron/tmux-fingers'

run '~/.tmux/plugins/tpm/tpm'
